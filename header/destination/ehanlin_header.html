<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>ehanlin</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://s3-ap-northeast-1.amazonaws.com/ehanlin-web-resource/common_webcomponent/current/header/ehanlin_header.css">
</head>

<body id="ehanlin-header" class="basic">
  <style type="text/css" rel="stylesheet"></style>

  <div>
    <a class="logo" href="./ehanlin_header.html" title="ehanlin - 翰林雲端學苑 - 首頁"></a>
    <div>免費諮詢專線：0800-0088-11</div>
    <ul class="header-menu">
      <li>
        <a href="" title="購物車">
        <i class="shoppingcart-shop20"> 購物車 </i>
        <span id="car_sum">0</span>
      </a>
      </li>

      <li>
        <a href="http://www.ehanlin.com.tw/inputsn.html" title="課程開通">課程開通</a>
      </li>

      <li>
        <a href="http://www.ehanlin.com.tw/type/TRIAL/SalesPlans.html" title="免費試用">免費試用</a>
      </li>

      <li>
        <a href="http://www.ehanlin.com.tw/qa.html" title="使用幫手">使用幫手</a>
      </li>

      <li>
        <iframe src="http://www.ehanlin.com.tw/ms_message/msgapi_test.html" frameborder="0" allowtransparency="true" style="width: 20px; height: 22px; margin-bottom: -7px;">
        </iframe>
      </li>

      <li>
        <a id="userStatus" class="userName"></a>
      </li>

      <li id="register">
        <a href="http://www.ehanlin.com.tw/Users/register.html" title="會員註冊">立即註冊</a>
      </li>

      <li id="loginBotton">
        <a>會員登入</a>
      </li>

      <li>
        <a href="https://www.facebook.com/ehanlin.com.tw/"><i class="fa">&#xf082;</i></a>
      </li>

      <li>
        <a href="http://line.me/R/ti/p/MtsRQz_Hn5"><i class="fa fa-share-alt-square" style="font-size:24px;color:#00B900"></i></a>
      </li>
  </div>

  <script type="text/javascript">
    $(function () {
      get = function (url, success, error) {
        return $.ajax({
          type: "GET",
          contentType: "application/json",
          dataType: "json",
          cache: false,
          crossDomain: true,
          success: success,
          error: error,
          url: url,
          xhrFields: { withCredentials: true }
        })
      }

      $('#loginBotton').click(function () {
        get("http://test.ehanlin.com.tw/ms-user-status/login?user=" + "521d946be4b0d765448570bd")
        get("http://test.ehanlin.com.tw/ms-user-status/userStatus", function (data) {
          if ($("#userStatus").length) {
            $(".userName").text(`${data.studentCard}  ${data.name}`).append(`    |    <li><a id="logoutButton">登出</a></li>`);
            $("#loginBotton").remove()
            $("#register").remove()
            alert("successful");
            html();
          } else {
            alert("empty data");
          }
        })

      })


      var html = function () {
        $('#logoutButton').on('click', function () {
          logoutPut("http://test.ehanlin.com.tw", null, "Users", "521d946be4b0d765448570bd/!logout", null, null, function (data) {
            window.location = "./ehanlin_header.html";
          });
          return false;
        });
      }

      var logoutPut = function (host, filter, resource, attribute, option, body, success, error) {
        return $.ajax({
          type: "PUT",
          contentType: "application/json",
          dataType: "json",
          cache: false,
          crossDomain: true,
          success: success,
          error: error,
          url: "http://test.ehanlin.com.tw/Users/521d946be4b0d765448570bd/!logout",
          data: bodyVal(body),
          xhrFields: { withCredentials: true }
        });
      };

      var bodyVal = function (body) {
        var bodyVal = "";
        if (body != null) {
          bodyVal = JSON.stringify({ value: body });
        }
        return bodyVal;
      }
    })
  </script>

</body>

</html>